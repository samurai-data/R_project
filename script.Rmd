---
title: "R_projet"
author: "Inessa Kim, Mai-Anh Pham, Nao Ueda"
date: 'Dernière modif : `r format(Sys.Date(), format = "%d/%m/%Y")`'
output:
  html_document:
    number_sections: yes # pour ajouter des numéros aux titres
    toc: yes # ajout d'une table des matières
    toc_depth : '3' # Précision de la table des matières
    toc_float: true # Laisser la table des matières constamment
---
# Checklist - Rappel des consignes pour le dossier

Il s’agira d’un dossier en groupe de 2 à 4 étudiant·es au choix à partir de données fournies et à rechercher autour d’une même thématique. Le dossier rendu sera :

- (OK) un document (.odt, .pdf ou **.html**)
- rédigé de 4 à 6 pages
- (OK) à partir d’un fichier .Rmd
- (OK) comportant au moins une carte
- présentant des résultats pondérés
- et au moins un test statistique.
-> Vous m’enverrez le document produit et le script .Rmd au plus tard **le 03/01/23** à mon adresse mail cecile.rodrigues@univ-lille.fr (vous aurez un accusé de réception sous 24h).

Attendus

- Au moins 2 vagues de coco (conseil 1 et 6)
- Résultats pondérés
- Au moins un test statistique
- Pas d’énumération de tests ou de tableaux sans réflexion, fil directeur et interprétation
- Recherche de données géographiques pertinentes (voir data.gouv.fr)
- Au moins une carte
- Données transmises : coco - vague 1 à coco - vague 6, les autres vagues, fonds départements et communes

# Présentation du sujet et de nos hypothèses sociologiques
Sujet : La charge mentale des femmes face au Covid

Définition : la charge mentale entrait dans l’édition 2020 du Larousse, définie comme « poids psychologique que fait peser (plus particulièrement sur les femmes) la gestion des tâches domestiques et éducatives, engendrant une fatigue physique et, surtout, psychique ».

"C'est devoir penser à tout, tout le temps, et pour tout le monde. C'est l'impression de devoir tout gérer, d'avoir l'impression aussi de devoir être parfait sur tous les fronts -sans réussir à tirer la sonnette d'alarme quand il faudrait- en pensant que tout repose sur ses propres épaules" détaille Laurence Bourgeois. 

Références :
https://www.europarl.europa.eu/RegData/etudes/BRIE/2022/719547/IPOL_BRI(2022)719547_FR.pdf
https://lejournal.cnrs.fr/nos-blogs/dialogues-economiques/la-charge-mentale-une-double-peine-pour-les-femmes
https://start.lesechos.fr/societe/egalite-diversite/charge-mentale-le-travail-domestique-des-meres-a-double-pendant-la-crise-selon-le-bcg-1295877
https://www.lecrsa.ca/wp-content/uploads/2022/04/RAPPORT_Charge-mentale_F_P-S.pdf
https://www.francetvinfo.fr/sante/maladie/coronavirus/il-ne-sait-pas-ce-que-c-est-que-de-gerer-les-enfants-a-la-maison-avec-le-covid-19-la-charge-mentale-pese-plus-lourd-sur-les-femmes_4328609.html

## Carte graphique : 
Données : https://www.data.gouv.fr/fr/datasets/chiffres-cles-concernant-lepidemie-de-covid19-en-france/
Fond de carte : fichier sous zip

## Données nécessaires et variables pertinentes - suggestion 
- Caratèristique socio-démograpghie de l'individu
  + Age décennal en 7 classes : cal_AGE1
  + Sexe : eayy_A1
  + Niveau de formation du I au VI (rép+conj) : eayy_B18C et eayy_B18CCJT
  + En activité : oui/non (rép+conj) : eayy_B1B et eayy_B1BCJT
  + Groupe socioprofessionnel en 6 postes (rép+conj) : eayy_PCS6 et eayy_PCS6CJT 
- Information du ménage
  + Type de ménage, 5 types (une seule personne/ monoparentale/ couple sans/ avec enfant/ complexe) : eayy_TYPMEN5
  + Nombre d'enfants cohabitants (0/1/2/3+/Non concerné) : eayy_C8B_rec
  + area >=25 m2 par personne (oui/non) : coco1_q26
  + Revenu mensuel par unité de consommation en 10 classes : eayy_E2AUC
- L'impact du télétravail et du confinement
  + Les sentiments négatifs (nerveux : Q16, découragé : Q17, triste : Q19), sentiment de solitude : eayy_F4 
  + Avis sur quotidien : journées denses : coco6_Q200_2 et stresse intense : coco6_Q200_4
  + Avis télétravail : permet de se concentrer : coco6_Q132_2, mélange trop vie privée et vie professionnelle : coco6_Q132_3
  + coco6_Q62mod: Expérience du confinement
  + coco6_Q25: Tensions au sein du ménage
- La division des tâches domestiques actuellement (toujours/souvent/parfois/jamais)
  + coco6_q135_1: Se charge de la cuisine ego, coco6_q135_2: conjoint.e
  + coco6_q136_1: Se charge des courses ego, coco6_q136_2: conjoint.e
  + coco6_q137_1: Se charge de la lessive ego, coco6_q137_2: conjoint.e
- Les tâches fait par répondant
  + coco6_Q51: Fréquence de la surveillance des travaux scolaires des enfants
  + coco6_q59_2: Temps consacré à : s’occuper de ses enfants
  + coco6_q59_3: Temps consacré à : prendre soin de personnes fragiles ou vulnérables
  + coco6_q59_4: Temps consacré à : exercer son activité professionnelle
- Les activités recréatives ou reposantes 
  + coco6_q59_5: Temps consacré à : faire des exercices physiques / du sport
  + coco6_q59_6: Temps consacré à : dormir
 
# Historique des étapes sur R
## Télécharger les packages
```{r}
library(tidyverse)
library(questionr)
library(readr)
library(knitr)
library(kableExtra)
```
*Les données : coco1 et coco6*
```{r}
coco1 <- read.csv("fr.cdsp.ddi.elipss.202004coco1.csv")
```

```{r}
coco6 <- read.csv("fr.cdsp.ddi.elipss.202010.csv")
```

## Choisir les variables

### Charactères socio-démographiques de l'individu 
```{r}
## eayy_A1: Sexe (enquête annuelle)
coco1$sexe <- fct_recode(
  factor(coco1$eayy_A1),
  "Homme"="1", "Femme"="2")
freq(coco1$sexe, total= T, valid=F)
```
```{r}
## eayy_A2A_rec: Age quinquennal (recodage) à 2018
coco1$age <- fct_recode(factor(coco1$eayy_A2A_rec),
  "Moins de 24"="4", "De 25 à 29 ans"="5", 
  "De 30 à 34 ans"="6", "De 35 à 39 ans"="7",
  "De 40 à 44 ans"="8", "De 45 à 49 ans"="9",
  "De 50 à 54 ans"="10", "De 55 à 59 ans"="11",
  "De 60 à 64 ans"="12", "De 65 à 69 ans"="13",
  "70 ans et plus"="14")
freq(coco1$age, total= T, valid=F)
```
```{r}
## eayy_A5: Vit en couple
coco1$couple <- fct_recode(factor(coco1$eayy_A5),
  "Couple cohabitation"="1", 
  "Couple non-cohabitation"="2", 
  "Ne pas en couple"="3")
freq(coco1$couple, total= T, valid=F)
```
### Information de la ménage 
```{r}
## eayy_C1_rec: Nombre de personnes dans le foyer (recodage)
freq(coco1$eayy_C1_rec, total= T, valid=F)
```
```{r}
## eayy_C8B_rec: Nombre d'enfants cohabitants (recodage)
coco1$enfants_cohabitation <- fct_recode(factor(coco1$eayy_C8B_rec),
  "0 enfant"="1", 
  "1 enfant"="2", 
  "2 enfants"="3",
  "3 enfants ou plus"="4",
  "Ne pas avoir d'enfant" = "6")
freq(coco1$enfants_cohabitation, total= T, valid=F)
```

### Les sentiments
```{r}
# Créer la fonction
fct_freq_senti <- function(x){
  recod <- fct_collapse(factor(x),
  "En permanence"="1", 
  "Souvent"="2", 
  "Quelques fois"="3",
  "Rarement"="4",
  "Jamais" = "5")
  return(recod)
}
# Recodage
coco1$nerveux <- fct_freq_senti(coco1$coco1_q16)
coco1$decourage <- fct_freq_senti(coco1$coco1_q17)
coco1$triste <- fct_freq_senti(coco1$coco1_q19)
```

### Les tâches
**Fréquences des activités concernantes la vie sociale Pendant les deux dernières semaines**

```{r}
# Créer la fonction
fct_freq_actvt <- function(x){
  recod <- fct_collapse(factor(x),
  "8 fois ou plus"="1", 
  "Entre 5 et 7 fois"="2", 
  "3 ou 4 fois"="3",
  "1 ou 2 fois"="4",
  "Jamais" = "5")
  return(recod)
}
# Recodage
# Rencontres les amis ou famille, dans la vie réelle ou virtuelle
coco1$rencontres_amis_reel <- fct_freq_actvt(coco1$coco1_q52_1)
coco1$rencontres_amis_vir <- fct_freq_actvt(coco1$coco1_q52_2)
coco1$rencontres_famille_reel <- fct_freq_actvt(coco1$coco1_q52_3)
coco1$rencontres_famille_vir <- fct_freq_actvt(coco1$coco1_q52_4)
# Contacts avec la famille, des amis, des collègues à l'étranger
coco1$contacts_etr_famille <- fct_freq_actvt(coco1$coco1_q53_1)
coco1$contacts_etr_amis <- fct_freq_actvt(coco1$coco1_q53_2)
coco1$contacts_etr_collegues <- fct_freq_actvt(coco1$coco1_q53_3)
```

**Temps consacré pour les activités**

Fonction
```{r}
fct_temps_actvt <- function(x){
  recod <- fct_collapse(factor(x),
  "Je n’ai pas fait cette activité"="1", 
  "Entre 0 et 1 heure"="2", 
  "Entre 1 et 2 heures"="3",
  "Entre 2 et 3 heures"="4",
  "Entre 3 et 4 heures"="5",
  "Entre 4 et 6 heures"="6",
  "Entre 6 et 8 heures"="7",
  "Entre 8 et 10 heures"="8",
  "Plus de 10 heures" = "9")
  return(recod)
}
```

Recodage
```{r}
# faire du ménage
coco1$tache_1 <- fct_temps_actvt(coco1$coco1_q59_1)
# s’occuper de ses enfants
coco1$tache_2 <- fct_temps_actvt(coco1$coco1_q59_2)
# prendre soin de personnes fragiles
coco1$tache_3 <- fct_temps_actvt(coco1$coco1_q59_3)
# exercer son activité professionnelle
coco1$tache_4 <- fct_temps_actvt(coco1$coco1_q59_4)
# faire des exercices physiques / du sport
coco1$tache_5 <- fct_temps_actvt(coco1$coco1_q59_5)
# dormir
coco1$tache_6 <- fct_temps_actvt(coco1$coco1_q59_6)
# parler au téléphone
coco1$tache_7 <- fct_temps_actvt(coco1$coco1_q59_7)

```

**Temps consacré pour les activités par rapport à l'habitude**

- 1 Beaucoup moins que d’habitude
- 2 Un peu moins que d’habitude 
- 3 Autant que d’habitude 
- 4 Un peu plus que d’habitude
- 5 Beaucoup plus que d’habitude
- 6 Non concerné(e)
- 9999 N'a pas répondu

*Les tâches*

- coco1_q61_1: Temps consacré par rapport à l'habitude à : faire du ménage
- coco1_q61_2: Temps consacré par rapport à l'habitude à : s’occuper - de ses enfants
- coco1_q61_3: Temps consacré par rapport à l'habitude à : prendre soin de personnes fragiles ou vulnérables
- coco1_q61_7: Temps consacré par rapport à l'habitude à : parler au téléphone
- coco1_q61_6: Temps consacré par rapport à l'habitude à : dormir
- coco1_q61_5: Temps consacré par rapport à l'habitude à : faire des exercices physiques / du sport

# Résultat produit et commentaires
## La repartition des tâches selon le sexe

En croiser les activités sociales avec le sexe, on voit que les femmes sont plus nombreux à garder les contacts avec leur famille pour donner les conseils, du confort. Elles les font plus souvent peut être pour exercer leur rôle de 'care giver' d'une femme selon les rapports sociaux de sexe. 

**La frequence des rencontres avec la famille dans la vraie vie selon sexe**
```{r}
lprop(table(coco1$sexe, coco1$rencontres_famille_reel, exclude="9999"))
```

**La frequence des rencontres avec la famille dans la vie virtuelle selon sexe**

```{r}
lprop(table(coco1$sexe, coco1$rencontres_famille_vir, exclude="9999"))
```
**La frequence des contacts avec la famille à l'étranger selon sexe**
```{r}
lprop(table(coco1$sexe, coco1$contacts_etr_famille, exclude="6"))
```


**Les femmes consacrent plus de temps à prendre soins de personnes fragiles ou vulnérables**
```{r}
rprop(table(coco1$sexe, coco1$tache_3, exclude="9999"))
```

**Les femmes passent plus de temps à s'occuper des enfants : 13,3 % des femmes consacrent plus de 6h par jour contre 5 % des hommes**

```{r}
rprop(table(coco1$sexe, coco1$tache_2, exclude="9999"))
```
**Tâches ménagères : 22,3 % des femmes passent plus de 2h à faire les tâches ménagères contre 10,2 % des hommes au cours de 2 dernières semaines. Il y a même 15 % des hommes qui ne l'ont pas fait.**
```{r}
rprop(table(coco1$sexe, coco1$tache_1, exclude="9999"))
```

## Le profil des femmes avec le plus de charge mentale

Croiser avec 

- la situation conjugale (en couple ou pas) 
- l'information du ménage (vit avec qui)
- position professionnelle d'elle et de son conjoint

# Bibliographie 
https://lejournal.cnrs.fr/nos-blogs/dialogues-economiques/la-charge-mentale-une-double-peine-pour-les-femmes

# Donnée surpprimentaire
https://www.data.gouv.fr/fr/pages/donnees-coronavirus/




#####################################################
#####################################################

---
title: "Test _projet R"
author: "N"
format: html
editor: visual
---

coco1 et coco6

{r}
coco1 <- read.csv("fr.cdsp.ddi.elipss.202004coco1.csv")

coco6 <- read.csv("fr.cdsp.ddi.elipss.202010.csv")

sexe 

{r}

fct_freq_sexe <- function(x){
  recod <- fct_collapse(factor(x),
  "Homme"="1",
  "Femme"="2")
  return(recod)
}

# Recodage
coco1$sexe <- fct_freq_sexe(coco1$eayy_A1)
coco6$sexe <- fct_freq_sexe(coco6$eayy_A1)

freq(coco1$sexe, total= T, valid=F)
freq(coco6$sexe, total= T, valid=F)

# poids de sexe par vague1 
wtd.table(coco1$sexe, weights = coco1$coco1_POIDS,
          useNA = "ifany")

wtd.table(coco1$sexe, weights = coco1$coco1_POIDS,
          useNA = "ifany") %>% 
  round()#<<

#poids de pourcentagesde sexe par vague1 
round(wtd.table(coco1$sexe, weights = coco1$coco1_POIDS,
          useNA = "ifany") %>% 
  prop.table()*100,1)#<<

# # poids de sexe par vague6 
wtd.table(coco6$sexe, weights = coco6$POIDS_coco6,
          useNA = "ifany")

wtd.table(coco6$sexe, weights = coco6$POIDS_coco6,
          useNA = "ifany") %>% 
  round()#<<

#poids de pourcentagesde sexe par vague6 
round(wtd.table(coco6$sexe, weights = coco6$POIDS_coco6,
          useNA = "ifany") %>% 
  prop.table()*100,1)#<<


ages 

{r}

fct_freq_age <- function(x){
  recod <- fct_collapse(factor(x),
  "Moins de 24"="4", "De 25 à 29 ans"="5", 
                        "De 30 à 34 ans"="6", "De 35 à 39 ans"="7",
                        "De 40 à 44 ans"="8", "De 45 à 49 ans"="9",
                        "De 50 à 54 ans"="10", "De 55 à 59 ans"="11",
                        "De 60 à 64 ans"="12", "De 65 à 69 ans"="13",
                        "70 ans et plus"="14")
  return(recod)
}

# Recodage
coco1$age <- fct_freq_age(coco1$eayy_A2A_rec)
coco6$age <- fct_freq_age(coco6$eayy_A2A_rec)


freq(coco1$age, total= T, valid=F)
freq(coco6$age, total= T, valid=F)

{r}
# Tableau de croise vague 1(groupe d'age et sexe) :
wtd.table(coco1$age,coco1$sexe,  
          weights = coco1$coco1_POIDS, useNA = "ifany") %>% 
  rprop(digits=1)

# Tableau de croise vague 6(groupe d'age et sexe) :
wtd.table(coco6$age,coco6$sexe,  
          weights = coco6$POIDS_coco6, useNA = "ifany") %>% 
  rprop(digits=1)

Groupe socioprofessionnel en 6 postes (rép+conj):eayy_PCS6 et eayy_PCS6CJT 

{r, warning=FALSE}
fct_freq_sociopro <- function(x){
  recod <- fct_collapse(factor(x),
                        "Agriculteurs exploitants"="1",
                        "Artisans, commerçants et chefs d'entreprise"="2", 
                        "Cadres et professions intellectuelles supérieures"="3",
                        "Professions intermédiaires"="4",
                        "Employés"="5", "Ouvriers"="6",
                        "Ne sait pas "=c("66","666" ,"999"))
  return(recod)
}

# Recodage

coco1$sociopro <- fct_freq_sociopro(coco1$eayy_PCS6)
coco6$sociopro <- fct_freq_sociopro(coco6$eayy_PCS6)



L’étude des caractéristiques socio des femmes pour décrire notre population

{r}
#vague1
wtd.table(coco1$sociopro,coco1$sexe,
          weights = coco1$coco1_POIDS, useNA = "ifany") %>% 
  rprop(digits=1)
#vague6
wtd.table(coco6$sociopro,coco6$sexe,
          weights = coco6$POIDS_coco6, useNA = "ifany") %>% 
  rprop(digits=1)

vie en couple

{r}
fct_freq_couple <- function(x){
  recod <- fct_collapse(factor(x),
  "Couple cohabitation"="1", 
  "Couple non-cohabitation"="2", 
  "Ne pas en couple"="3")
  return(recod)
}

# Recodage
coco1$couple <- fct_freq_couple(coco1$eayy_A5)
coco6$couple <- fct_freq_couple(coco6$eayy_A5)
## eayy_A5: Vit en couple

freq(coco1$couple, total= T, valid=F)
freq(coco6$couple, total= T, valid=F)


{r}
# Tableau de croise vague 1(couple et sexe) :
wtd.table(coco1$couple,coco1$sexe,  
          weights = coco1$coco1_POIDS, useNA = "ifany") %>% 
  rprop(digits=1)

# Tableau de croise vague 6(couple et sexe) :
wtd.table(coco6$couple,coco6$sexe,
          weights = coco6$POIDS_coco6, useNA = "ifany") %>% 
  rprop(digits=1)



sentiment croise de pop femmes

#solitude 

{r}
# Créer la fonction
fct_freq_senti_solitude <- function(x){
  recod <- fct_collapse(factor(x),
  "Très seul(e)"="1", 
  "Plutôt seul(e)"="2", 
  "Plutôt entouré(e)"="3",
  "Très entouré(e)t"="4",
  "Ne sais pas" = "9999")
  return(recod)
}
#Recodage
coco1$solitude <- fct_freq_senti_solitude(coco1$coco1_q21)

{r}
# Créer la fonction
fct_freq_senti <- function(x){
  recod <- fct_collapse(factor(x),
  "En permanence"="1", 
  "Souvent"="2", 
  "Quelques fois"="3",
  "Rarement"="4",
  "Jamais" = "5")
  return(recod)
}
# Recodage
coco1$nerveux <- fct_freq_senti(coco1$coco1_q16)
coco1$decourage <- fct_freq_senti(coco1$coco1_q17)
coco1$triste <- fct_freq_senti(coco1$coco1_q19)

coco6$nerveux <- fct_freq_senti(coco1$coco1_q16)
coco6$decourage <- fct_freq_senti(coco1$coco1_q17)
coco6$triste <- fct_freq_senti(coco1$coco1_q19)


